# üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Telegram-–±–æ—Ç–∞

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –±–æ—Ç–∞, —Å–æ–±–∏—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö.

---

## üéØ –ß—Ç–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è

### 1. –†–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –±–æ—Ç–æ–≤
- ‚úÖ –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –±–æ—Ç –∂–∏–≤ –∏ –æ—Ç–≤–µ—á–∞–µ—Ç
- ‚úÖ –ê–¥–º–∏–Ω-–±–æ—Ç –∂–∏–≤ –∏ –æ—Ç–≤–µ—á–∞–µ—Ç
- ‚è±Ô∏è –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ API
- üîó –°—Ç–∞—Ç—É—Å webhook (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

### 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- üíæ –§–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- üìè –†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- üîì –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (—á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å)

### 3. –ú–µ—Ç—Ä–∏–∫–∏ –±–∏–∑–Ω–µ—Å–∞
- üìù –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ (—Å–µ–≥–æ–¥–Ω—è/–≤—Å–µ–≥–æ)
- üë• –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–æ–≤—ã–µ/–≤—Å–µ–≥–æ)
- üî• –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏
- üìà –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –¥–Ω—è–º

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –û–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å–∏—Å—Ç–µ–º—ã
python monitor.py

# –í—ã–≤–æ–¥ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON
python monitor.py --json
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```
======================================================================
  üîç –ú–û–ù–ò–¢–û–†–ò–ù–ì TELEGRAM-–ë–û–¢–ê
======================================================================

üìÖ –í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏: 2025-12-27T10:30:00

‚úÖ –°–¢–ê–¢–£–°: –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ

ü§ñ –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –±–æ—Ç:
   ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (@your_client_bot)
   ‚è±  –û—Ç–∫–ª–∏–∫: 245.67ms

üë®‚Äçüíº –ê–¥–º–∏–Ω-–±–æ—Ç:
   ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (@your_admin_bot)
   ‚è±  –û—Ç–∫–ª–∏–∫: 198.34ms

üíæ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
   ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
   üì¶ –†–∞–∑–º–µ—Ä: 2.45 MB
   üìù –ß—Ç–µ–Ω–∏–µ: ‚úì
   ‚úèÔ∏è  –ó–∞–ø–∏—Å—å: ‚úì
```

---

## üìä –ü–æ–∫–∞–∑–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏

```bash
python monitor.py --metrics
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```
======================================================================
  üîç –ú–û–ù–ò–¢–û–†–ò–ù–ì TELEGRAM-–ë–û–¢–ê
======================================================================

üìä –ú–µ—Ç—Ä–∏–∫–∏ –±–æ—Ç–∞

üìÖ –î–∞—Ç–∞: 2025-12-27

üìà –°–µ–≥–æ–¥–Ω—è:
   üìù –ù–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤: 12
   üë§ –ù–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 5

üìä –í—Å–µ–≥–æ:
   üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 245
   üìã –ó–∞–∫–∞–∑–æ–≤: 1,056

üî• –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏ (–∑–∞ –Ω–µ–¥–µ–ª—é):
   1. –ú–∞–Ω–∏–∫—é—Ä: 45 –∑–∞–∫–∞–∑–æ–≤
   2. –ü–µ–¥–∏–∫—é—Ä: 38 –∑–∞–∫–∞–∑–æ–≤
   3. –°—Ç—Ä–∏–∂–∫–∞: 22 –∑–∞–∫–∞–∑–∞
   4. –û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ: 15 –∑–∞–∫–∞–∑–æ–≤
   5. –ú–∞—Å—Å–∞–∂: 10 –∑–∞–∫–∞–∑–æ–≤
```

---

## üîó –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Webhook

```bash
python monitor.py --webhook
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ (–µ—Å–ª–∏ webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω):**
```
üîó –ü—Ä–æ–≤–µ—Ä–∫–∞ Webhook

ü§ñ –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –±–æ—Ç:
   ‚úÖ URL: https://bot.yourdomain.com/webhook/client
   üì® –û–∂–∏–¥–∞—é—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: 0

üë®‚Äçüíº –ê–¥–º–∏–Ω-–±–æ—Ç:
   ‚úÖ URL: https://bot.yourdomain.com/webhook/admin
   üì® –û–∂–∏–¥–∞—é—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: 0
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è polling):**
```
üîó –ü—Ä–æ–≤–µ—Ä–∫–∞ Webhook

ü§ñ –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –±–æ—Ç:
   ‚ÑπÔ∏è  Webhook –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è polling)

üë®‚Äçüíº –ê–¥–º–∏–Ω-–±–æ—Ç:
   ‚ÑπÔ∏è  Webhook –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è polling)
```

---

## üëÅÔ∏è –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
python monitor.py --watch

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
python monitor.py --watch --interval 60

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç (600 —Å–µ–∫—É–Ω–¥)
python monitor.py --watch --interval 600
```

**–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:** `logs/monitoring/health_YYYYMMDD.json`

---

## üîî –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (cron)

–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –≤ crontab –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:

```bash
# –û—Ç–∫—Ä—ã—Ç—å crontab
crontab -e

# –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
*/5 * * * * cd /path/to/digital_admin_bot && python3 monitor.py --json >> logs/monitoring/cron.log 2>&1
```

**–ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π:**
```bash
# –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
*/5 * * * * ...

# –ö–∞–∂–¥—ã–π —á–∞—Å
0 * * * * ...

# –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00
0 9 * * * ...

# –ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 10:00
0 10 * * 1 ...
```

---

## üö® –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –≤ Telegram

–°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `monitor_with_alerts.py`:

```python
#!/usr/bin/env python3
"""
–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
"""
import asyncio
import os
from dotenv import load_dotenv
from aiogram import Bot
from utils.monitoring import run_health_check

load_dotenv()

ALERT_CHAT_ID = os.getenv("ADMIN_TELEGRAM_ID")  # –í–∞—à Telegram ID
ADMIN_BOT_TOKEN = os.getenv("ADMIN_BOT_TOKEN")


async def monitor_and_alert():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞–ª–µ—Ä—Ç –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã"""
    client_token = os.getenv("CLIENT_BOT_TOKEN")
    admin_token = os.getenv("ADMIN_BOT_TOKEN")
    db_path = "data/bot_data.sqlite"

    # –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É
    report = await run_health_check(client_token, admin_token, db_path)

    # –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    if report['overall_status'] != 'healthy':
        bot = Bot(token=ADMIN_BOT_TOKEN)

        message = "üö® –ü–†–û–ë–õ–ï–ú–ê –í –†–ê–ë–û–¢–ï –ë–û–¢–ê!\n\n"

        if report['client_bot']['status'] != 'healthy':
            message += f"‚ùå –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –±–æ—Ç: {report['client_bot'].get('error', '–û—à–∏–±–∫–∞')}\n"

        if report['admin_bot']['status'] != 'healthy':
            message += f"‚ùå –ê–¥–º–∏–Ω-–±–æ—Ç: {report['admin_bot'].get('error', '–û—à–∏–±–∫–∞')}\n"

        if report['database']['status'] != 'healthy':
            message += f"‚ùå –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: {report['database'].get('error', '–û—à–∏–±–∫–∞')}\n"

        message += f"\n‚è∞ –í—Ä–µ–º—è: {report['timestamp']}"

        await bot.send_message(ALERT_CHAT_ID, message)
        await bot.session.close()

        print(f"üö® –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–æ–±–ª–µ–º–µ")
    else:
        print("‚úÖ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã –≤ –ø–æ—Ä—è–¥–∫–µ")


if __name__ == "__main__":
    asyncio.run(monitor_and_alert())
```

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```bash
ADMIN_TELEGRAM_ID=your_telegram_id_here
```

–î–æ–±–∞–≤—å—Ç–µ –≤ crontab:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç —Å –∞–ª–µ—Ä—Ç–∞–º–∏
*/5 * * * * cd /path/to/digital_admin_bot && python3 monitor_with_alerts.py >> logs/alerts.log 2>&1
```

---

## üìà –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

### Prometheus + Grafana

–°–æ–∑–¥–∞–π—Ç–µ `metrics_exporter.py` –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –º–µ—Ç—Ä–∏–∫ –≤ Prometheus:

```python
#!/usr/bin/env python3
"""
–≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ –¥–ª—è Prometheus
"""
from prometheus_client import start_http_server, Gauge, Counter
import time
import asyncio
from utils.monitoring import BotMonitor, DatabaseMonitor
from utils.db_manager import DatabaseManager
from utils.monitoring import MetricsCollector
import os
from dotenv import load_dotenv

load_dotenv()

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏
bot_up = Gauge('telegram_bot_up', 'Bot is up', ['bot_name'])
bot_response_time = Gauge('telegram_bot_response_time_ms', 'Bot API response time', ['bot_name'])
db_size = Gauge('telegram_bot_db_size_bytes', 'Database size in bytes')
orders_total = Counter('telegram_bot_orders_total', 'Total orders')
users_total = Counter('telegram_bot_users_total', 'Total users')


async def collect_metrics():
    """–°–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è Prometheus"""
    client_token = os.getenv("CLIENT_BOT_TOKEN")
    admin_token = os.getenv("ADMIN_BOT_TOKEN")
    db_path = "data/bot_data.sqlite"

    client_monitor = BotMonitor(client_token, "client")
    admin_monitor = BotMonitor(admin_token, "admin")
    db_monitor = DatabaseMonitor(db_path)

    while True:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–æ—Ç—ã
        client_status = await client_monitor.check_bot_alive()
        admin_status = await admin_monitor.check_bot_alive()

        bot_up.labels(bot_name='client').set(1 if client_status['status'] == 'healthy' else 0)
        bot_up.labels(bot_name='admin').set(1 if admin_status['status'] == 'healthy' else 0)

        if client_status['status'] == 'healthy':
            bot_response_time.labels(bot_name='client').set(client_status['response_time_ms'])
        if admin_status['status'] == 'healthy':
            bot_response_time.labels(bot_name='admin').set(admin_status['response_time_ms'])

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ë–î
        db_status = db_monitor.check_db_health()
        if db_status['status'] == 'healthy':
            db_size.set(db_status['size_bytes'])

        # –°–æ–±–∏—Ä–∞–µ–º –º–µ—Ç—Ä–∏–∫–∏ –±–∏–∑–Ω–µ—Å–∞
        db_manager = DatabaseManager(db_path)
        collector = MetricsCollector(db_manager)
        metrics = collector.collect_daily_metrics()

        if 'total_orders' in metrics:
            orders_total._value.set(metrics['total_orders'])
        if 'total_users' in metrics:
            users_total._value.set(metrics['total_users'])

        await asyncio.sleep(30)  # –°–æ–±–∏—Ä–∞–µ–º –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥


if __name__ == '__main__':
    # –ó–∞–ø—É—Å–∫–∞–µ–º HTTP-—Å–µ—Ä–≤–µ—Ä –¥–ª—è Prometheus –Ω–∞ –ø–æ—Ä—Ç—É 8000
    start_http_server(8000)
    print("üìä Metrics exporter started on :8000")
    asyncio.run(collect_metrics())
```

**–ó–∞–ø—É—Å–∫:**
```bash
python3 metrics_exporter.py
```

**–ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞:** http://localhost:8000

---

## üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Ä—É—á–Ω—É—é

### –ï–∂–µ–¥–Ω–µ–≤–Ω–æ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ cron)
- ‚úÖ –ë–æ—Ç—ã –∂–∏–≤—ã –∏ –æ—Ç–≤–µ—á–∞—é—Ç
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
- ‚úÖ –ù–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ
- üìä –ê–Ω–∞–ª–∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —É—Å–ª—É–≥
- üë• –†–æ—Å—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üíæ –†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ >100 MB - —Å–¥–µ–ª–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é)

### –ï–∂–µ–º–µ—Å—è—á–Ω–æ
- üîê –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ certbot)
- üóÑÔ∏è –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- üìà –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤ –∏ –º–µ—Ç—Ä–∏–∫

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç (timeout)

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. Telegram API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
3. –ë–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω
ps aux | grep python

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
ping google.com

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –±–æ—Ç–∞
tail -f logs/bot.log

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
sudo systemctl restart telegram-bot
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –§–∞–π–ª –ë–î —É–¥–∞–ª–µ–Ω –∏–ª–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω
2. –ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
3. –î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
ls -lh data/bot_data.sqlite

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞
chmod 664 data/bot_data.sqlite

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ
df -h
```

### Webhook –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏—Å—Ç–µ–∫
2. nginx –Ω–µ –∑–∞–ø—É—â–µ–Ω
3. –ë–æ—Ç –Ω–µ —Å–ª—É—à–∞–µ—Ç –Ω–∞ –Ω—É–∂–Ω–æ–º –ø–æ—Ä—Ç—É

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
sudo certbot certificates

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å nginx
sudo systemctl status nginx

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±–æ—Ç —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç
netstat -tlnp | grep 8080
```

---

## üìù –õ–æ–≥–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–í—Å–µ –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `logs/monitoring/`:

```
logs/monitoring/
‚îú‚îÄ‚îÄ health_20251227.json    # –û—Ç—á–µ—Ç—ã –∑–∞ 27.12.2025
‚îú‚îÄ‚îÄ health_20251228.json    # –û—Ç—á–µ—Ç—ã –∑–∞ 28.12.2025
‚îî‚îÄ‚îÄ cron.log                # –õ–æ–≥–∏ cron-–∑–∞–¥–∞–Ω–∏–π
```

**–§–æ—Ä–º–∞—Ç JSON:**
```json
{
  "overall_status": "healthy",
  "client_bot": {
    "status": "healthy",
    "username": "your_bot",
    "response_time_ms": 245.67,
    "checked_at": "2025-12-27T10:30:00"
  },
  "admin_bot": { ... },
  "database": { ... },
  "timestamp": "2025-12-27T10:30:00"
}
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ (< 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
‚úÖ –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Ä—É—á–Ω—É—é
‚úÖ Cron –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
‚ùå Prometheus/Grafana –Ω–µ –Ω—É–∂–Ω—ã

### –î–ª—è —Å—Ä–µ–¥–Ω–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ (100-1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
‚úÖ Cron –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
‚úÖ –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫
‚ùå Prometheus/Grafana –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

### –î–ª—è –∫—Ä—É–ø–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ (> 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
‚úÖ –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (--watch)
‚úÖ –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram
‚úÖ Prometheus + Grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚úÖ –ê–ª–µ—Ä—Ç–∏–Ω–≥ –ø—Ä–∏ –∞–Ω–æ–º–∞–ª–∏—è—Ö

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞! –¢–µ–ø–µ—Ä—å –≤—ã –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç–µ –∑–Ω–∞—Ç—å –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞.

**–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
```bash
# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
python monitor.py

# –ú–µ—Ç—Ä–∏–∫–∏
python monitor.py --metrics

# Webhook —Å—Ç–∞—Ç—É—Å
python monitor.py --webhook

# –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
python monitor.py --watch
```
